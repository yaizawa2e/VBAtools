# VBAtools

VBAを便利に使うためのライブラリなどをいくつか提供します。

* Iconv.cls
   * Iconvのような文字コード変換機能を提供するクラスです。
     内部的にはADODB.Streamを使って文字コードを変換しますのでMicrosoft ActiveX Data Objectsを参照設定してお使いください。
   * ADODB.Streamの文字コード指定だけでは若干使いにくいため、次のような挙動をするようにしています。
      * Shift_JISの別名として「CP932」「MS932」を使用可能にしています。
      * ADODB.Streamの挙動としてUTF-8、UTF-16LEではBOM (Byte Order Mark) が挿入されてしまうため、「UTF-8N」の場合はBOMなしUTF-8を、「UTF-16LE」の場合はBOMなしUTF-16LEを出力します。
         * そもそもUTF-16BE/LEではBOMを出力するのは[UTF-16の仕様に反する挙動](https://en.wikipedia.org/wiki/UTF-16#Byte_order_encoding_schemes)のため、ActiveXの挙動がおかしいです。
         * UTF-8でも何故かBOMが付く時と付かない時があるため、先頭2バイトないし3バイトを確認してBOMがある場合のみ除去します。
* ColorUniversalDesignV4.xlsx
   * [カラーユニバーサルデザイン推奨配色セット](https://jfly.uni-koeln.de/colorset/)に掲載されている推奨配色セット v.4をパレットとして追加しています。
   * P.3-7で共通しｈたアクセントカラー (6色) を使っているほか、テキスト/背景色として無彩色の4色を設定しています。ハイパーリンクの色もアクセントカラーの青と紫にしています。
   * ベースカラーについては設定できませんので、ご使用の際にはご注意ください。
   * ご参考として、推奨色として掲載されている色についてはシート上に一覧掲載しました。
      * ただし、代替黄・代替緑については塗装用のみの代替色として用意されているため、基本的には使用しないでください。
      * 代替色のRGBについては[(一社)日本塗料工業会](https://www.toryo.or.jp/)の提供している[ペイントカラー検索システム](https://www.toryo.or.jp/jp/color/color.html)で照会したRGB値を使用しています。ただし本システムで紹介したRGB値は配色セットに記載されているRGB値と一致していないため、若干PDF上の掲載色と差異があります。おそらくγ補正により差異が発生しているものと思われます。
